Based on example here: http://www.homeandlearn.co.uk/csharp/csharp_s9p6.html