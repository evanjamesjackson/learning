Based on example here: http://www.homeandlearn.co.uk/csharp/csharp_s4p12.html