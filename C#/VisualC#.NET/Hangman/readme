Based on example here: http://www.homeandlearn.co.uk/csharp/csharp_s8p10.html